clc;clear all;close all;

filename='ori2_model_transport.dat';
ori_file='ori_model_transport.dat';
clm_file='qco_model_transport.dat';
da_file='da_model_transport.dat';
filename2='total_obs_1993-2007.dat';


data=load(filename);
oridata=load(ori_file);
clmdata=load(clm_file);
dadata=load(da_file);
fid=fopen(filename2);
c_header=textscan(fid,'%s %s %s %s %s %s %s %s',1);
c_data=textscan(fid,'%f %f %f %f %f %f %f %f');
fclose(fid);
data2=[c_data{3},c_data{4},c_data{5},c_data{6},c_data{7}];

data_leng=length(data(:,1));

% set(gcf,'PaperUnits','inches','PaperPosition',[0 0 4 3])

%================================korea


figure(1)
figure('position',[500 300 1100 550],'PaperUnits','inches','PaperPosition',[0 0 11 5]);
set(gca,'Position',[0.08 0.12 .89 0.8]);
hold on
hl1=line([1:1:data_leng],data(:,1),'color','b','linewidth',1.5);
xlim([1 data_leng]);ylim([1 5]);
%  set(gca,'xtick',[1+6:12:data_leng+6],...
%      'xticklabel',{'1993','1994','1995','1996','1997','1998','1999'},...
%      'ytick',[1:0.5:5],...
%      'yticklabel',{'1.0','1.5','2.0','2.5','3.0','3.5','4.0','4.5','5.0'},...
%      'fontsize',14);
   set(gca,'xtick',[1+6:12:data_leng+6],...
     'xticklabel',{'93','94','95','96','97','98','99','00','01',...
     '02','03','04','05','06','07','08','09','10','11'},...
     'ytick',[1:0.5:5],...
     'yticklabel',{'1.0','1.5','2.0','2.5','3.0','3.5','4.0','4.5','5.0'},...
     'fontsize',17);
 xlabel('Year','fontsize',18);ylabel('Transport(Sv)','fontsize',18);
ax(2)=axes('Position',get(gca,'Position'),...
   'XAxisLocation','bottom',... 
   'YAxisLocation','left');
hl6=line([1:1:data_leng],oridata(1:data_leng,1),'color',[.5 .5 .5],'linewidth',1.5);
% hl7=line([1:1:data_leng],clmdata(1:data_leng,1),'color',[0 .5 .5],'linewidth',1.5);
hl1=line([1:1:data_leng],data(:,1),'color','b','linewidth',1.5);
% hl7=line([1:1:data_leng],dadata(1:data_leng,1),'color',[0 .8 0],'linewidth',1.5);
hl2=line([1:1:data_leng],data2(1:data_leng,1),'color','r','Parent',ax(2),'linewidth',1.5);
% hl3=line([1:1:data_leng],data2(1:data_leng,2),'color',[0 .9 0],'Parent',ax(2),'linewidth',1.5);
% hl4=line([1:1:data_leng],data2(1:data_leng,3),'color',[0 .9 .9],'Parent',ax(2),'linewidth',1.5);
% hl5=line([1:1:data_leng],data2(1:data_leng,4),'color','k','Parent',ax(2),'linewidth',1.5);
% hl6=line([1:1:data_leng],data2(1:data_leng,5),'color','m','Parent',ax(2),'linewidth',1.5);
xlim([1 data_leng]);ylim([1 5])
 set(gca,'xtick',[1:12:data_leng],...
     'xticklabel',{'',' ',' ','',' ',' ',''},...
     'ytick',[1:0.5:5],...
     'yticklabel',{' ',' ',' ',' ',' ',' ',' ',' ',' ',' '},...
     'box','on','xgrid','on','gridlinestyle','--');
  legend_str{1}='Control(3.5)';legend_str{2}='Control(3.6)';
  legend_str{3}='Sea level diff.(Nishimura et al., 2008)';
le1=legend(legend_str,'Location', 'NorthWest');
  set(le1,'fontsize',13)
  title('Korea strait volume transport','fontsize',17);
 saveas(gcf,'ep_korea transport','tif')


%=============================soya


 figure(2)
 figure('position',[500 300 1100 350],'PaperUnits','inches','PaperPosition',[0 0 11 4]);
 set(gca,'Position',[0.12 0.15 .85 0.75]);
 hold on
hl1=line([1:1:data_leng],data(:,6),'color','b','linewidth',1.5);
xlim([1 data_leng]);ylim([-0.5 2.5]);
%  set(gca,'xtick',[1+6:12:data_leng+6],...
%      'xticklabel',{'1993','1994','1995','1996','1997','1998','1999'},...
%      'ytick',[-0.5:0.5:2.5],...
%      'yticklabel',{'-0.5','0.0','0.5','1.0','1.5','2','2.5'},...
%      'fontsize',14);
   set(gca,'xtick',[1+6:12:data_leng+6],...
     'xticklabel',{'93','94','95','96','97','98','99','00','01',...
     '02','03','04','05','06','07','08','09','10','11'},...
     'ytick',[-0.5:0.5:2.5],...
     'yticklabel',{'-0.5','0.0','0.5','1.0','1.5','2','2.5'},...
     'fontsize',17);
 xlabel('Year','fontsize',18);ylabel('Transport(Sv)','fontsize',18);
ax(2)=axes('Position',get(gca,'Position'),...
   'XAxisLocation','bottom',... 
   'YAxisLocation','left');
hl2=line([1:1:data_leng],oridata(1:data_leng,6),'color',[.5 .5 .5],'Parent',ax(2),'linewidth',1.5);
hl1=line([1:1:data_leng],data(:,6),'color','b','linewidth',1.5);
xlim([1 data_leng]);ylim([-0.5 2.5])
 set(gca,'xtick',[1:12:data_leng],...
     'xticklabel',{'',' ',' ','',' ',' ',''},...
     'ytick',[-0.5:0.5:2.5],...
     'yticklabel',{' ',' ',' ',' ',' ',' ',' '},...
     'box','on','xgrid','on','gridlinestyle','--');
%   legend('Model','fontsize',13,'orientation','horizontal',2)
  le2=legend('Control(3.5)', 'Control(3.6)','orientation','horizontal',2);
  set(le2,'fontsize',15)
  title('Soya strait volume transport','fontsize',17);
  saveas(gcf,'ep_soya transport','tif')
 
  
 %=========================tsugaru

 
 figure(3)
 figure('position',[500 300 1100 350],'PaperUnits','inches','PaperPosition',[0 0 11 4]);
 set(gca,'Position',[0.12 0.15 .85 0.75]);
 hold on
hl1=line([1:1:data_leng],data(:,5),'color','b','linewidth',1.5); 
xlim([1 data_leng]);ylim([0.5 3]);
%  set(gca,'xtick',[1+6:12:data_leng+6],...
%      'xticklabel',{'1993','1994','1995','1996','1997','1998','1999'},...
%      'ytick',[0.5:0.5:3],...
%      'yticklabel',{'0.5','1.0','1.5','2.0','2.5','3.0'},...
%      'fontsize',14);
   set(gca,'xtick',[1+6:12:data_leng+6],...
     'xticklabel',{'93','94','95','96','97','98','99','00','01',...
     '02','03','04','05','06','07','08','09','10','11'},...
     'ytick',[0.5:0.5:3],...
     'yticklabel',{'0.5','1.0','1.5','2.0','2.5','3.0'},...
     'fontsize',17);
 xlabel('Year','fontsize',18);ylabel('Transport(Sv)','fontsize',18);
ax(2)=axes('Position',get(gca,'Position'),...
   'XAxisLocation','bottom',... 
   'YAxisLocation','left');
hl2=line([1:1:data_leng],oridata(1:data_leng,5),'color',[.5 .5 .5],'Parent',ax(2),'linewidth',1.5);
hl1=line([1:1:data_leng],data(:,5),'color','b','linewidth',1.5);
% hl2=line([1:1:data_leng],data2(1:data_leng,5),'color','r','Parent',ax(2),'linewidth',1.5);
xlim([1 data_leng]);ylim([0.5 3])
 set(gca,'xtick',[1:12:data_leng],...
     'xticklabel',{'',' ',' ','',' ',' ',''},...
     'ytick',[0.5:0.5:3],...
     'yticklabel',{' ',' ',' ',' ',' ',' '},...
     'box','on','xgrid','on','gridlinestyle','--');
%  legend('Model','fontsize',13,'orientation','horizontal',2)
  le3=legend('Control(3.5)', 'Control(3.6)','orientation','horizontal',2);
  set(le3,'fontsize',15)
  title('Tsugaru strait volume transport','fontsize',17);
 saveas(gcf,'ep_tsugaru transport','tif')
 
 
 %=============================taiwan
 
 
  figure(4)
 figure('position',[500 300 1100 350],'PaperUnits','inches','PaperPosition',[0 0 11 4]);
 set(gca,'Position',[0.12 0.15 .85 0.75]);
 hold on
hl1=line([1:1:data_leng],data(:,3),'color','b','linewidth',1.5); 
xlim([1 data_leng]);ylim([-0.5 3]);
%  set(gca,'xtick',[1+6:12:data_leng+6],...
%      'xticklabel',{'1993','1994','1995','1996','1997','1998','1999'},...
%      'ytick',[-0.5:0.5:3.0],...
%      'yticklabel',{'-0.5','0.0','0.5','1.0','1.5','2.0','2.5','3.0'},...
%      'fontsize',14,'xminortick','on');
   set(gca,'xtick',[1+6:12:data_leng+6],...
     'xticklabel',{'93','94','95','96','97','98','99','00','01',...
     '02','03','04','05','06','07','08','09','10','11'},...
     'ytick',[-0.5:0.5:3.0],...
     'yticklabel',{'-0.5','0.0','0.5','1.0','1.5','2.0','2.5','3.0'},...
     'fontsize',17);
 xlabel('Year','fontsize',18);ylabel('Transport(Sv)','fontsize',18);
ax(2)=axes('Position',get(gca,'Position'),...
   'XAxisLocation','bottom',... 
   'YAxisLocation','left');
hl2=line([1:1:data_leng],oridata(1:data_leng,3),'color',[.5 .5 .5],'Parent',ax(2),'linewidth',1.5);
hl1=line([1:1:data_leng],data(:,3),'color','b','linewidth',1.5);
% hl2=line([1:1:data_leng],data2(1:data_leng,3),'color','r','Parent',ax(2),'linewidth',1.5);
xlim([1 data_leng]);ylim([-0.5 3])
 set(gca,'xtick',[1:12:data_leng],...
     'xticklabel',{'',' ',' ','',' ',' ',''},...
     'ytick',[-0.5:0.5:3.0],...
     'yticklabel',{' ',' ',' ',' ',' ',' ',' ',' '},...
     'box','on','xgrid','on','gridlinestyle','--');
  le4=legend('Control(3.5)', 'Control(3.6)','orientation','horizontal',2);
  set(le4,'fontsize',15)
  title('Taiwan strait volume transport','fontsize',17);
 saveas(gcf,'ep_taiwan transport','tif')

 %=================================onshore
 
   figure(5)
 figure('position',[500 300 1100 350],'PaperUnits','inches','PaperPosition',[0 0 11 4]);
 set(gca,'Position',[0.12 0.15 .85 0.75]);
 hold on
hl1=line([1:1:data_leng],data(:,7),'color','b','linewidth',1.5); 
xlim([1 data_leng]);ylim([-1 4]);
%  set(gca,'xtick',[1+6:12:data_leng+6],...
%      'xticklabel',{'1993','1994','1995','1996','1997','1998','1999'},...
%      'ytick',[-1:0.5:4.0],...
%      'yticklabel',{'-1.0','-0.5','0.0','0.5','1.0','1.5','2.0','2.5','3.0','3.5','4.0'},...
%      'fontsize',14);
   set(gca,'xtick',[1+6:12:data_leng+6],...
     'xticklabel',{'93','94','95','96','97','98','99','00','01',...
     '02','03','04','05','06','07','08','09','10','11'},...
     'ytick',[-1:0.5:4.0],...
     'yticklabel',{'-1.0','-0.5','0.0','0.5','1.0','1.5','2.0','2.5','3.0','3.5','4.0'},...
     'fontsize',17);
 xlabel('Year','fontsize',18);ylabel('Transport(Sv)','fontsize',18);
ax(2)=axes('Position',get(gca,'Position'),...
   'XAxisLocation','bottom',... 
   'YAxisLocation','left');
hl2=line([1:1:data_leng],oridata(1:data_leng,7),'color',[.5 .5 .5],'Parent',ax(2),'linewidth',1.5);
hl1=line([1:1:data_leng],data(:,7),'color','b','linewidth',1.5);
% hl2=line([1:1:data_leng],data2(1:data_leng,7),'color','r','Parent',ax(2),'linewidth',1.5);
xlim([1 data_leng]);ylim([-1 4])
 set(gca,'xtick',[1:12:data_leng],...
     'xticklabel',{'',' ',' ','',' ',' ','',},...
     'ytick',[-1:0.5:4.0],...
     'yticklabel',{' ',' ',' ',' ',' ',' ',' ',' ',' ','',''},...
     'box','on','xgrid','on','gridlinestyle','--');
%  legend('Model','fontsize',13,'orientation','horizontal',2)
  le5=legend('Control(3.5)', 'Control(3.6)','orientation','horizontal',2);
  set(le5,'fontsize',15)
  title('Onshore volume transport','fontsize',17);
 saveas(gcf,'onshore transport','tif')
 
 
 %=================================jeju
 
 
 
 figure(6)
 figure('position',[500 300 1100 350],'PaperUnits','inches','PaperPosition',[0 0 11 4]);
 set(gca,'Position',[0.12 0.15 .85 0.75]);
 hold on
hl1=line([1:1:data_leng],data(:,7),'color','b','linewidth',1.5); 
xlim([1 data_leng]);ylim([0 0.5]);
%  set(gca,'xtick',[1+6:12:data_leng+6],...
%      'xticklabel',{'1993','1994','1995','1996','1997','1998','1999'},...
%      'ytick',[-1:0.5:4.0],...
%      'yticklabel',{'-1.0','-0.5','0.0','0.5','1.0','1.5','2.0','2.5','3.0','3.5','4.0'},...
%      'fontsize',14);
   set(gca,'xtick',[1+6:12:data_leng+6],...
     'xticklabel',{'93','94','95','96','97','98','99','00','01',...
     '02','03','04','05','06','07','08','09','10','11'},...
     'ytick',[0:0.1:0.5],...
     'yticklabel',{'0.0','0.1','0.2','0.3','0.4','0.5'},...
     'fontsize',17);
 xlabel('Year','fontsize',18);ylabel('Transport(Sv)','fontsize',18);
ax(2)=axes('Position',get(gca,'Position'),...
   'XAxisLocation','bottom',... 
   'YAxisLocation','left');
hl2=line([1:1:data_leng],oridata(1:data_leng,8),'color',[.5 .5 .5],'Parent',ax(2),'linewidth',1.5);
hl1=line([1:1:data_leng],data(:,8),'color','b','linewidth',1.5);
xlim([1 data_leng]);ylim([0 0.5])
 set(gca,'xtick',[1:12:data_leng],...
     'xticklabel',{'',' ',' ','',' ',' ','',},...
     'ytick',[-1:0.5:4.0],...
     'yticklabel',{' ',' ',' ',' ',' ',' '},...
     'box','on','xgrid','on','gridlinestyle','--');
%  legend('Model','fontsize',13,'orientation','horizontal',2)
  le6=legend('Control(3.5)', 'Control(3.6)','orientation','horizontal',2);
  set(le6,'fontsize',15)
  title('Jeju strait volume transport','fontsize',17);
 saveas(gcf,'jeju transport','tif') 

